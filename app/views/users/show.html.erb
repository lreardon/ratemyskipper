<div class='flex flex-col gap-10'>
  <div class="flex flex-row">
    <%= render 'shared/button/link', title: 'Users', path: users_path, twcss_color: 'bg-gray-100' %>
  </div>
  <div class='flex flex-col gap-10'>
    <div>
      <h1><%= @user.name %></h1>
      <h3>Since <%= readable_datetime_month_year(@user.created_at) %></h3>
    </div>
    <div>
      <p class='text-2xl'><%= pluralize(@user.authored_reviews.count, 'review') %></p>
      <p class='text-2xl'><%= pluralize(@user.friends.count, 'friend') %></p>
    </div>
  <div class="w-full flex justify-end">
    <% if current_user == @user %>
      <div class='flex flex-col'>
        <div class="flex flex-row gap-3">
          <%= render 'shared/button/link', title: 'Edit', path: edit_user_path(@user), twcss_color: 'bg-yellow-100' %>
          <%= render 'shared/button/form', title: 'Delete', path: @user, method: :delete, twcss_color: 'bg-red-100', data: {turbo_confirm: 'Are you sure? This action is permanent!'} %>
        </div>
      </div>
    <% elsif !current_user.friendship_exists_with?(@user) %>
      <%= render 'shared/button/form', title: 'Add Friend', path: friendships_path, method: :post, twcss_color: 'bg-blue-100', params: { friendship: {user_id: current_user.id, friend_id: @user.id}} %>
    <% elsif current_user.friends_with?(@user)%>
      <p class="rounded-lg py-3 px-5 bg-blue-100 text-lg">Friends!</p>
    <% else %>
      <p class="rounded-lg py-3 px-5 bg-blue-100 text-lg">Friendship Pending</p>    
    <% end %>
  </div>
  <% if current_user == @user %>
    <!-- TODO: Extract all of this into its own 'friends' partial. -->
    <div class='flex flex-col gap-5 xl:gap-10'>
      <div class='flex flex-col gap-3 xl:gap-5'>
        <h3>Friends</h3>
        <div class='flex flex-col gap-3 items-start'>
          <% if (friendships = @user.friendships).present? %>
            <%= render partial: 'friendships/friendship', collection: friendships, as: :friendship %>
          <% else %>
            <p class='text-light'>You don't have any friends yet! Why not?</p>
          <% end %>
        <div>
      </div>
      <div class='flex flex-col gap-3 xl:gap-5'>
        <h3>Friend Requests</h3>
        <div class='flex flex-col gap-3 items-start'>
          <% if (pending_friendships = @user.pending_friendships).present? %>
            <%= render partial: 'friendships/pending_friendship', collection: pending_friendships, as: :friendship %>
          <% else %>
            <p class='text-light'>No friend requests.</p>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
  </div>
</div>
